name: DeepRVAT Pipeline tests
run-name: DeepRVAT Pipeline tests 🧬🧪💻🧑‍🔬
on: [ push ]

jobs:

  # Preprocessing With QC
  Smoke-Preprocessing-With-QC:
    uses: ./.github/workflows/run-pipeline.yml
    with:
      environment_file: ./deeprvat_preprocessing_env.yml
      name: Preprocessing-With-QC
      pipeline_file: ./pipelines/preprocess_with_qc.snakefile
      pipeline_directory: ./example/preprocess
      pipeline_config: ./pipelines/config/deeprvat_preprocess_config.yaml
      download_example_data: true

  Pipeline-Tests-Preprocessing-With-QC:
    needs: Smoke-Preprocessing-With-QC
    uses: ./.github/workflows/run-pipeline.yml
    with:
      environment_file: ./deeprvat_env_no_gpu.yml
      name: Pipeline-Tests-Preprocessing-No-QC
      pipeline_file: ./pipelines/preprocess_with_qc.snakefile
      pipeline_directory: ./example/preprocess
      pipeline_config: ./pipelines/config/deeprvat_preprocess_config.yaml
      dry_run: false
      download_example_data: true

