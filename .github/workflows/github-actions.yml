name: DeepRVAT
run-name: DeepRVAT 🧬🧪💻🧑‍🔬
on: [ push ]
jobs:
  Main-DeepRVAT-Pipeline-Smoke-Tests:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Training Association Testing smoke test
        uses: snakemake/snakemake-github-action@v1.24.0
        with:
          directory: 'example'
          snakefile: 'pipelines/training_association_testing.snakefile'
          args: '-j 1 -n'
          stagein: 'pip install -e ${{ github.workspace }}'
      - name: Seed Gene Discovery Smoke Test
        uses: snakemake/snakemake-github-action@v1.24.0
        with:
          directory: 'example'
          snakefile: 'pipelines/seed_gene_discovery.snakefile'
          args: '-j 1 -n'
      - name: Association Testing Pretrained Smoke Test
        uses: snakemake/snakemake-github-action@v1.24.0
        with:
          stagein: 'ln -s pretrained_models example/pretrained_models'
          directory: 'example'
          snakefile: 'pipelines/association_testing_pretrained.snakefile'
          args: '-j 1 -n'
  Pre-DeepRVAT-Pipeline-Smoke-Tests:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Annotations Smoke Test
        uses: snakemake/snakemake-github-action@v1.24.0
        with:
          directory: 'example'
          snakefile: 'pipelines/annotations.snakefile'
          args: '-j 1 -n --configfile pipelines/config/deeprvat_annotation_config.yaml'
      - name: Preprocess Smoke Test
        uses: snakemake/snakemake-github-action@v1.24.0
        with:
          directory: 'example'
          snakefile: 'pipelines/preprocess.snakefile'
          args: '-j 1 -n --configfile pipelines/config/deeprvat_preprocess_config.yaml'
